"use strict";var tslib_1=require("tslib");function inferLocale(){if(document&&document.documentElement)return document.documentElement.lang}function convertNumber(e){return"-Inf"===e?-1/0:"+Inf"===e||"Inf"===e||"*"===e?1/0:parseInt(e,10)}function applyReplacements(e,t){return Object.keys(t).sort(function(e,s){return s.length-e.length}).forEach(function(a){e=e.replace(new RegExp(":"+a,"gi"),function(e){var s=t[a];return e===e.toUpperCase()?s.toUpperCase():e===e.replace(/\w/i,function(e){return e.toUpperCase()})?s.charAt(0).toUpperCase()+s.slice(1):s})}),e}var intervalRegexp=/^({\s*(\-?\d+(\.\d+)?[\s*,\s*\-?\d+(\.\d+)?]*)\s*})|([\[\]])\s*(-Inf|\*|\-?\d+(\.\d+)?)\s*,\s*(\+?Inf|\*|\-?\d+(\.\d+)?)\s*([\[\]])$/;function testInterval(e,s){var a=(s=s.trim()).match(intervalRegexp);if(!a)throw new Error("Invalid interval: "+s);if(!a[2]){var t=(a=a.filter(function(e){return!!e}))[1],r=convertNumber(a[2]);r===1/0&&(r=-1/0);var c=convertNumber(a[3]),n=a[4];return("["===t?r<=e:r<e)&&("]"===n?e<=c:e<c)}for(var o=a[2].split(","),l=0;l<o.length;l++)if(parseInt(o[l],10)===e)return!0;return!1}function getPluralForm(e,s){switch(s){case"az":case"bo":case"dz":case"id":case"ja":case"jv":case"ka":case"km":case"kn":case"ko":case"ms":case"th":case"tr":case"vi":case"zh":return 0;case"af":case"bn":case"bg":case"ca":case"da":case"de":case"el":case"en":case"eo":case"es":case"et":case"eu":case"fa":case"fi":case"fo":case"fur":case"fy":case"gl":case"gu":case"ha":case"he":case"hu":case"is":case"it":case"ku":case"lb":case"ml":case"mn":case"mr":case"nah":case"nb":case"ne":case"nl":case"nn":case"no":case"om":case"or":case"pa":case"pap":case"ps":case"pt":case"so":case"sq":case"sv":case"sw":case"ta":case"te":case"tk":case"ur":case"zu":return 1==e?0:1;case"am":case"bh":case"fil":case"fr":case"gun":case"hi":case"hy":case"ln":case"mg":case"nso":case"xbr":case"ti":case"wa":return 0===e||1===e?0:1;case"be":case"bs":case"hr":case"ru":case"sr":case"uk":return e%10==1&&e%100!=11?0:2<=e%10&&e%10<=4&&(e%100<10||20<=e%100)?1:2;case"cs":case"sk":return 1==e?0:2<=e&&e<=4?1:2;case"ga":return 1==e?0:2==e?1:2;case"lt":return e%10==1&&e%100!=11?0:2<=e%10&&(e%100<10||20<=e%100)?1:2;case"sl":return e%100==1?0:e%100==2?1:e%100==3||e%100==4?2:3;case"mk":return e%10==1?0:1;case"mt":return 1==e?0:0===e||1<e%100&&e%100<11?1:10<e%100&&e%100<20?2:3;case"lv":return 0===e?0:e%10==1&&e%100!=11?1:2;case"pl":return 1==e?0:2<=e%10&&e%10<=4&&(e%100<12||14<e%100)?1:2;case"cy":return 1==e?0:2==e?1:8==e||11==e?2:3;case"ro":return 1==e?0:0===e||0<e%100&&e%100<20?1:2;case"ar":return 0===e?0:1==e?1:2==e?2:3<=e%100&&e%100<=10?3:11<=e%100&&e%100<=99?4:5;default:return 0}}function flat(r,c){return Object.keys(r).reduce(function(e,s){var a=r[s],t=c?c+"."+s:s;return"string"==typeof a?(e[t]=r[s],e):tslib_1.__assign({},e,flat(a,t))},{})}var DEFAULT_LOCALE="en",anyIntervalRegexp=/({\s*(\-?\d+(\.\d+)?[\s*,\s*\-?\d+(\.\d+)?]*)\s*})|([\[\]])\s*(-Inf|\*|\-?\d+(\.\d+)?)\s*,\s*(\+?Inf|\*|\-?\d+(\.\d+)?)\s*([\[\]])/,Lang=function(){function e(e){if(this.locale=null,this.fallback=null,this.messages={},!e)throw new Error("options must be defined");this.locale=e.locale||inferLocale()||DEFAULT_LOCALE,this.fallback=e.fallback,this.setMessages(e.messages)}return e.prototype.setMessages=function(e){e&&(this.messages=flat(e))},e.prototype.getLocale=function(){return this.locale},e.prototype.setLocale=function(e){this.locale=e},e.prototype.getFallback=function(){return this.fallback},e.prototype.setFallback=function(e){this.fallback=e},e.prototype.get=function(e,s,a){if(!e)return null;e=e.replace(/\//g,".");var t=this._parseKey(e,a),r=t.source,c=t.sourceFallback,n=this.messages[r];return void 0===n&&void 0===(n=this.messages[c])?e:s?applyReplacements(n,s):n},e.prototype.trans=function(e,s,a){return this.get(e,s,a)},e.prototype.has=function(e,s){var a=this.get(e,null,s);return null!==a&&a!==e},e.prototype.choice=function(e,s,a,t){void 0===a&&(a={}),a.count=s;var r=this.get(e,a,t);if(null===r)return r;for(var c=r.split("|"),n=[],o=0;o<c.length;o++)if(c[o]=c[o].trim(),anyIntervalRegexp.test(c[o])){var l=c[o].split(/\s/);n.push(l.shift()),c[o]=l.join(" ")}if(1===c.length)return r;for(var u=0;u<n.length;u++)if(testInterval(s,n[u]))return c[u];return c[getPluralForm(s,t=t||this._getLocaleFromExistingMessage(e,t))]},e.prototype.transChoice=function(e,s,a,t){return this.choice(e,s,a,t)},e.prototype._getLocaleFromExistingMessage=function(e,s){var a=this._parseKey(e,s);return this.messages[a.source]?this.locale:this.messages[a.sourceFallback]?this.fallback:null},e.prototype._parseKey=function(e,s){return e=e.replace(/\//g,"."),{source:(s||this.locale)+"."+e,sourceFallback:this.fallback+"."+e}},e}();module.exports=Lang;
